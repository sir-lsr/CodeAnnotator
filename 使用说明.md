# CodeAnnotator 项目交付说明

### 环境要求
- **Node.js**：v16.0 或以上
- **Python**：3.10 或以上
- **操作系统**：Windows、macOS、Linux

### 一键安装（Windows）
```bash
# 1. 双击运行安装脚本
install.bat

# 2. 启动所有服务
start-all.bat

# 3. 访问系统
浏览器打开：http://localhost:5173
```

### 手动安装

#### 后端安装
```bash
cd backend

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境（Windows）
venv\Scripts\activate

# 激活虚拟环境（Mac/Linux）
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt

# 配置环境变量（复制 env.example 为 .env 并填写 API Key）
copy env.example .env

# 启动后端服务
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

#### 前端安装
```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 访问：http://localhost:5173
```

### 生产环境部署
```bash
# 前端构建
cd frontend
npm run build

# 后端生产模式
cd backend
uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4
```

---

##  配置说明

### LLM API 配置

系统支持多种 LLM 提供商，需要在首次使用前配置 API Key：

#### 方式一：通过界面配置（推荐）
1. 访问系统后，点击左侧菜单"系统设置"
2. 在"LLM 配置"选项卡中填写：
   - 选择提供商（OpenAI/Claude/自定义）
   - 填写 API Key
   - 选择模型
   - 点击"测试连接"验证配置
   - 保存设置

#### 方式二：通过配置文件
编辑 `backend/.env` 文件：

```env
# OpenAI 配置
OPENAI_API_KEY=sk-your-openai-api-key-here
DEFAULT_LLM_PROVIDER=openai
DEFAULT_MODEL=gpt-3.5-turbo

# 或使用 Claude
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
DEFAULT_LLM_PROVIDER=anthropic
DEFAULT_MODEL=claude-3-sonnet-20240229

# 或使用 DeepSeek（兼容 OpenAI API）
OPENAI_API_KEY=sk-your-deepseek-api-key-here
OPENAI_BASE_URL=https://api.deepseek.com
DEFAULT_MODEL=deepseek-coder
```

#### 支持的模型
- **OpenAI**：gpt-3.5-turbo、gpt-4、gpt-4-turbo、gpt-4o
- **Claude**：claude-3-opus、claude-3-sonnet、claude-3-haiku
- **DeepSeek**：deepseek-coder、deepseek-chat
- **其他**：任何兼容 OpenAI API 格式的模型

---

##  API 文档

后端服务启动后，可访问自动生成的 API 文档：

- **Swagger UI**：http://localhost:8000/docs
- **ReDoc**：http://localhost:8000/redoc

主要 API 端点：

### 项目管理
- `GET /api/projects` - 获取项目列表
- `POST /api/projects` - 创建项目
- `GET /api/projects/{id}` - 获取项目详情
- `PUT /api/projects/{id}` - 更新项目
- `DELETE /api/projects/{id}` - 删除项目
- `POST /api/projects/{id}/archive` - 归档项目

### 文件管理
- `POST /api/files/upload` - 上传文件
- `POST /api/files/git-import` - Git 导入
- `GET /api/files/{id}` - 获取文件详情
- `GET /api/files/project/{id}/list` - 获取项目文件列表
- `DELETE /api/files/{id}` - 删除文件

### 标注管理
- `POST /api/annotations/generate` - 生成标注
- `GET /api/annotations` - 获取标注列表
- `PUT /api/annotations/{id}` - 更新标注
- `POST /api/annotations/{id}/approve` - 审核通过
- `POST /api/annotations/{id}/reject` - 审核拒绝
- `DELETE /api/annotations/{id}` - 删除标注

### 质量评估
- `GET /api/quality/summary` - 获取质量摘要
- `GET /api/quality/project/{id}` - 获取项目质量评估
- `GET /api/quality/file/{id}` - 获取文件质量评估

---

## 使用流程

### 典型工作流程

1. **创建项目**
   - 进入"项目列表"页面
   - 点击"创建项目"按钮
   - 填写项目名称和描述
   - 创建成功

2. **上传代码**
   - 点击项目卡片进入代码标注页面
   - 选择"上传文件"或"Git 导入"
   - 上传/导入代码文件
   - 等待文件处理完成

3. **生成标注**
   - 在文件列表中选择文件
   - 点击"生成标注"按钮
   - 系统自动调用 LLM 分析代码
   - 等待标注生成完成（通常 10-30 秒）

4. **查看和编辑标注**
   - 在代码编辑器中查看标注
   - 鼠标悬停查看详细信息
   - 点击标注可进行编辑或删除
   - 支持手动添加新标注

5. **审核标注**
   - 进入"标注审核"页面
   - 查看所有待审核标注
   - 对每条标注进行审核（通过/拒绝）
   - 支持批量审核操作

6. **质量评估**
   - 进入"质量评估"页面
   - 查看整体质量概览
   - 选择项目查看详细评估
   - 分析文件质量指标
   - 查看质量趋势图表

---


*文档版本：v1.0*  
*最后更新：2025年10月25日*
